<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/polymer/polymer.html">

<dom-module id="summary-view">

  <style>
    :host {
      display: block;
    }
    .title {
      font-weight: 100;
      margin: 0;
      font-size: 1.4em;
    }
    .title.large {
      font-size: 2em;
    }
    .number,
    .description {
      text-align: center;
      display: block;
      padding: 0 0.5em;
    }
    .description {
      font-size: 0.75em;
    }
    .highlight-positive {
      color: rgb(50,158,65);
    }
    .highlight-negative {
      color: rgb(255,82,64);
    }
  </style>

  <template>
    <div class="layout horizontal">
      <h4 class="flex title {{titleSize}}">[[_getName()]]</h4>
      <div class="flex" title="Estimated future revenue">
        <span class="number">{{computeValue('orderbook')}}</span>
        <span class="description">Orderbook</span>
      </div>
      <div class="flex" title="Estimated revenue for this month.">
        <span class="number">{{computeValue('valuecreation')}}</span>
        <span class="description">VC (month)</span>
      </div>
      <div class="flex" title="Estimated profit divided by revenue">
        <span class="number">{{computeValue('ebit')}}</span>
        <span class="description">EBIT (month)</span>
      </div>
      <div class="flex" title="Number of persons working for project this month, converted to full time employees.">
        <span class="number">{{computeValue('fte')}}</span>
        <span class="description">FTE</span>
      </div>
    </div>
  </template>
</dom-module>
<script>
  (function () {
    Polymer({
      is: 'summary-view',

      properties: {
        name: {
          type: String
        },
        data: {
          type: Array
        },
        titleSize: {
          type: String
        }
      },
      _getName: function() {
        if (this.name) {
          return this.name;
        } else if (this.data.name) {
          return this.data.name;
        } else {
          return '';
        }
      },
      computeValue: function(propName) {
        switch (propName) {
          case 'orderbook':
            return this.format(
                data.orderbook / 1000,
                1, 'k€'
              );
          case 'valuecreation':
            return this.format(
                data.value_creation_this_month / 1000,
                1, 'k€'
              );
          case 'ebit':
            return this.format(
                data.ebit_margin_this_month * 100,
                1, '%'
              );
          case 'fte':
            return this.format(
                data.fte_this_month,
                1
              );
          default:
            return '';
        }
      },
      format: function(value, precision, unit) {
        if (!Number(value)) {
          return '-';
        }
        var result = Number(value).toFixed(precision);
        if (unit) {
          result += ' '+unit;
        }
        return result;
      }
    });
  })();
</script>
